
<!DOCTYPE html>
<html lang="en">
<head>
	<style>
		.navsettings {
			padding-left: 0.6rem !important;
			padding-right: 0.6rem !important;
		}
	</style>

	
	
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"></script>
	<script src="/assets/js/general39.js"></script>

	<script>

		var clipboard = new ClipboardJS('.copy-link');
		clipboard.addEventListener('success', function(e) {
				var myToast = new bootstrap.Toast(document.getElementById('toast-success'));
				myToast.show();
				console.log(e);
		});
		clipboard.addEventListener('error', function(e) {
				var myToast = new bootstrap.Toast(document.getElementById('toast-error'));
				myToast.show();
				console.log(e);
		});


		//email change

		// Show confirm password field when user clicks email box

		document.getElementById('new_email').addEventListener('input', function () {

			var id = document.getElementById("email-password");
			var id2 = document.getElementById("email-password-label");
			var id3 = document.getElementById("emailpasswordRequired");

			id.classList.remove("d-none");
			id2.classList.remove("d-none");
			id3.classList.remove("d-none");

		});
	
		// 2FA toggle modal

		document.getElementById('2faModal').addEventListener('hidden.bs.modal', function () {

			var box = document.getElementById("2faToggle");
			
			box.checked = !box.checked;

		});

	
		//Email verification text

		function emailVerifyText() {

			document.getElementById("email-verify-text").innerHTML = "Verification email sent! Please check your inbox.";

		}
	</script>

	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">
	<meta name="author" content="">

	<link rel="icon" type="image/png" href="/assets/images/{{'SITE_NAME' | app_config}}/icon.webp">

	<title>{% block pagetitle %}Settings - {{'SITE_NAME' | app_config}}{% endblock %}</title>
		<meta property="og:type" content="article" />
		<meta property="og:title" content="{{'SITE_NAME' | app_config}}" />
		<meta property="og:site_name" content="{{request.host}}" />
		<meta property="og:image" content="{{'SITE_NAME' | app_config}}/assets/images/{{'SITE_NAME' | app_config}}/preview.webp" />
		<meta property="og:url" content="{{request.host}}">
		<meta property="og:description" name="description" content="{{'SITE_NAME' | app_config}} - {{'SLOGAN' | app_config}}">
		<meta property="og:author" name="author" content="@{{request.host_url}}" />
		<meta property="og:site_name" content="{{request.host}}" />

		<meta name="twitter:card" content="summary_large_image"/>
		<meta name="twitter:site" content="@{{request.host_url}}">
		<meta name="twitter:title" content="{{'SITE_NAME' | app_config}}" />
		<meta name="twitter:creator" content="@{{request.host_url}}">
		<meta name="twitter:description" content="{{'SITE_NAME' | app_config}} - {{'SLOGAN' | app_config}}" />
		<meta name="twitter:image" content="{{'SITE_NAME' | app_config}}/assets/images/{{'SITE_NAME' | app_config}}/preview.webp" />
		<meta name="twitter:url" content="{{request.host}}" />
	<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600&display=swap" rel="stylesheet">


	<!-- {{'SITE_NAME' | app_config}} CSS -->

	<link rel="stylesheet" href="/assets/css/{{v.theme}}_{{v.themecolor}}.css">
	{% if v.agendaposter %}<link rel="stylesheet" href="/assets/css/agendaposter.css">{% elif v.css %}<link rel="stylesheet" href="/@{{v.username}}/css">{% endif %}

	<!-- Font Awesome -->
	<link href="/assets/css/fa.css" rel="stylesheet"> <!--load all styles -->

	<script>
		function formkey() {
			return '{{v.formkey}}';
		}
	</script>
</head>

<body id="settings" style="overflow-x: hidden; {% if v and v.background %} background:url(/assets/images/backgrounds/{{v.background}}) no-repeat center center fixed !important; background-size: cover!important; background-color: #000!important;{% endif %}">

	{% include "header.html" %}
	<!-- Page Content -->
	<div class="container">

		<div class="row justify-content-around">

	<div class="col h-100">

		{% if error %}
		<div class="alert alert-danger alert-dismissible fade show my-3" role="alert">
			<i class="fas fa-exclamation-circle my-auto"></i>
			<span>
				{{error}}
			</span>
			<button type="button" class="close" data-bs-dismiss="alert" aria-label="Close">
				<span aria-hidden="true"><i class="far fa-times"></i></span>
			</button>
		</div>
		{% endif %}
		{% if msg %}
		<div class="alert alert-success alert-dismissible fade show my-3" role="alert">
			<i class="fas fa-check-circle my-auto" aria-hidden="true"></i>
			<span>
				{{msg}}
			</span>
			<button type="button" class="close" data-bs-dismiss="alert" aria-label="Close">
				<span aria-hidden="true"><i class="far fa-times"></i></span>
			</button>
		</div>
		{% endif %}

		<div class="mt-3">

			<h1 class="d-none d-md-block">Settings</h1>

			<h2 class="h3 d-md-none">Settings</h2>

		</div>

		<!-- Settings tabs -->

		<!-- Desktop -->

		<div class="flex-row bg-white box-shadow-bottom sticky d-none d-sm-flex mt-3 mb-3 mb-sm-5">

			<ul class="nav settings-nav">
				<li class="nav-item">
					<a class="nav-link{% if request.path=='/settings/profile' %} active{% endif %}" href="/settings/profile">Profile</a>
				</li>
				<li class="nav-item">
					<a class="nav-link{% if request.path=='/settings/content' %} active{% endif %}" href="/settings/content">Content</a>
				</li>
				<li class="nav-item">
					<a class="nav-link{% if request.path=='/settings/css' %} active{% endif %}" href="/settings/css">Custom CSS</a>
				</li>
				<li class="nav-item">
					<a class="nav-link{% if request.path=='/settings/profilecss' %} active{% endif %}" href="/settings/profilecss">Profile CSS</a>
				</li>
				<li class="nav-item">
					<a class="nav-link{% if request.path=='/settings/security' %} active{% endif %}" href="/settings/security">Security</a>
				</li>
				<li class="nav-item">
					<a class="nav-link{% if request.path=='/settings/blocks' %} active{% endif %}" href="/settings/blocks">Block users</a>
				</li>
				<li class="nav-item">
					<a class="nav-link{% if request.path=='/settings/apps' %} active{% endif %}" href="/settings/apps">Apps</a>
				</li>
				<li class="nav-item">
					<a class="nav-link{% if 'shop' in request.path %} active{% endif %}" href="/settings/shop">Shop</a>
				</li>
			</ul>

		</div>

		<!-- Mobile -->

		<div class="flex-row bg-white box-shadow-bottom sticky justify-content-center d-flex d-sm-none mt-3 mb-3 mb-sm-5">

			<ul class="nav settings-nav">
				<li class="nav-item">
					<a class="nav-link{% if request.path=='/settings/profile' %} active{% endif %} navsettings" href="/settings/profile"><i class="fas fa-cog text-lg mr-0"></i></a>
				</li>
				<li class="nav-item">
					<a class="nav-link{% if request.path=='/settings/content' %} active{% endif %} navsettings" href="/settings/content"><i class="fas fa-filter text-lg mr-0"></i></a>
				</li>
				<li class="nav-item">
					<a class="nav-link{% if request.path=='/settings/css' %} active{% endif %} navsettings" href="/settings/css"><i class="fas fa-palette text-lg mr-0"></i></a>
				</li>
				<li class="nav-item">
					<a class="nav-link{% if request.path=='/settings/profilecss' %} active{% endif %} navsettings" href="/settings/profilecss"><i class="fas fa-palette text-lg mr-0"></i></a>
				</li>
				<li class="nav-item">
					<a class="nav-link{% if request.path=='/settings/security' %} active{% endif %} navsettings" href="/settings/security"><i class="fas fa-lock-alt text-lg mr-0"></i></a>
				</li>
				<li class="nav-item">
					<a class="nav-link{% if request.path=='/settings/blocks' %} active{% endif %} navsettings" href="/settings/blocks"><i class="fas fa-user-minus text-lg mr-0"></i></a>
				</li>
				<li class="nav-item">
					<a class="nav-link{% if request.path=='/settings/apps' %} active{% endif %} navsettings" href="/settings/apps"><i class="fas fa-code text-lg mr-0"></i></a>
				</li>
				<li class="nav-item">
					<a class="nav-link{% if 'shop' in request.path %} active{% endif %} navsettings" href="/settings/shop"><i class="fas fa-store text-lg mr-0"></i></a>
				</li>
			</ul>

		</div>

	{% block content %}
	{% endblock %}
	
	</div>
</div>

 </div>

 {% if v %}
	<!-- 2FA Modal -->
	<div class="modal fade" id="2faModal" tabindex="-1" role="dialog" aria-labelledby="2faModalTitle" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">{% if mfa_secret %}Setup two-step login{% elif mfa_secret and not v.email %}Email required for two-step login{% else %}Disable two-step login{% endif %}</h5>
					<button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
						<span aria-hidden="true"><i class="far fa-times"></i></span>
					</button>
				</div>
				{% if mfa_secret %}
				<div>
					<form action="/settings/security" method="post">
						<input type="hidden" name="formkey" value="{{v.formkey}}">
						<input type="hidden" name="2fa_secret" value="{{mfa_secret}}">
						<div class="modal-body">
							<p>
								<span class="font-weight-bold">Step 1:</span> Scan this barcode (or enter the code) using a two-factor authentication app such as Google Authenticator or Authy.
							</p>
							<div class="text-center mb-3">
								<img loading="lazy" class="img-fluid" style="width: 175px;" src="/2faqr/{{mfa_secret}}">
								<pre></pre>
								<div class="text-small text-muted">Or enter this code: {{mfa_secret}}</div>
							</div>
							<p>
								<span class="font-weight-bold">Step 2:</span> Enter the six-digit code generated in the authenticator app and your {{'SITE_NAME' | app_config}} account password.
							</p>
							<label for="2fa_input">6-digit code</label>
							<input type="text" class="form-control mb-2" id="2fa_input" name="2fa_token" placeholder="# # # # # #" required>

							<label for="2fa_input_password">Password</label>
							<input type="password" autocomplete="new-password" class="form-control mb-2" id="2fa_input_password" name="password" oninput="document.getElementById('enable2faButton').disabled=false" autocomplete="off" required>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-link text-muted" data-bs-dismiss="modal">Cancel</button>
							<input id="enable2faButton" class="btn btn-primary" type="submit" value="Enable 2-step login" disabled>
						</div>
					</form>
				</div>
				{% else %}
				<div>
					<form action="/settings/security" method="post">
						<input type="hidden" name="formkey" value="{{v.formkey}}">
						<input type="hidden" name="2fa_secret" value="{{mfa_secret}}">
						<div class="modal-body">

							<div class="alert alert-warning" role="alert">
								<i class="fas fa-info-circle"></i>
								To disable two-step login, please enter your {{'SITE_NAME' | app_config}} account password and the 6-digit code generated in your authentication app. If you no longer have your two-step device, <a href="/lost_2fa">click here</a>.
							</div>

							<label for="2fa_input_password">Password</label>
							<input type="password" autocomplete="new-password" class="form-control mb-2" id="2fa_input_password" name="password" autocomplete="off" required>

							<label for="2fa_input">6-digit code</label>
							<input type="text" class="form-control mb-2" id="2fa_input" name="2fa_remove" placeholder="# # # # # #" oninput="document.getElementById('disable2faButton').disabled=false" required>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-link text-muted" data-bs-dismiss="modal">Cancel</button>
							<input id="disable2faButton" class="btn btn-primary" type="submit" value="Disable 2-step login" disabled>
						</div>
					</form>
				</div>
				{% endif %}
			</div>
		</div>
	</div>
{% endif %}

 <!-- Clipboard Toast -->

{% block clipboard %}
<div class="toast clipboard" id="toast-success" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="true" data-bs-delay="5000">
	<div class="toast-body text-center">
		<i class="fas fa-check-circle text-success mr-2"></i>Link copied to clipboard
	</div>
</div>

<div class="toast clipboard" id="toast-error" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="true" data-bs-delay="5000">
	<div class="toast-body text-center">
		<i class="fas fa-exclamation-circle text-danger mr-2"></i>Unable to copy link
	</div>
</div>
{% endblock %}


<!--Post toasts -->
<div class="toast" id="toast-post-success" style="position: fixed; bottom: 1.5rem; margin: 0 auto; left: 0; right: 0; width: 275px; z-index: 1000" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="true" data-bs-delay="5000">
	<div class="toast-body bg-success text-center text-white">
		<i class="fas fa-comment-alt-smile mr-2"></i><span id="toast-post-success-text"></span>
	</div>
</div>
<div class="toast" id="toast-post-error" style="position: fixed; bottom: 1.5rem; margin: 0 auto; left: 0; right: 0; width: 275px; z-index: 1000" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="true" data-bs-delay="5000">
	<div class="toast-body bg-danger text-center text-white">
		<i class="fas fa-exclamation-circle mr-2"></i><span id="toast-post-error-text"></span>
	</div>
</div>



{% block onload %}{% endblock %}

<pre>



</pre>

</body>

</html>